{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "description": "项目多级索引系统配置文件 - 放置在 .claude/index-config.json",

  "exclude": {
    "description": "排除规则配置",
    "patterns": [
      "**/node_modules/**",
      "**/.git/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/target/**",
      "**/vendor/**",
      "**/__pycache__/**",
      "**/.cache/**",
      "**/coverage/**",
      "**/.vscode/**",
      "**/.idea/**"
    ],
    "files": [
      "*.min.js",
      "*.bundle.js",
      "*.d.ts",
      "*.lock",
      "*.log"
    ],
    "useGitignore": true,
    "description": "是否自动读取 .gitignore 并应用其规则"
  },

  "index": {
    "description": "索引生成配置",
    "autoUpdate": true,
    "description": "是否启用 PostToolUse Hook 自动更新",

    "maxDepth": 10,
    "description": "最大扫描目录深度，0 表示无限制",

    "minFilesForFolder": 1,
    "description": "文件夹至少包含多少个代码文件才生成 FOLDER_INDEX.md",

    "maxFileSize": 524288,
    "description": "最大文件大小（字节），超过此大小的文件仅部分分析 (默认 512KB)",

    "updateThreshold": {
      "description": "更新阈值 - 何时触发各级索引更新",
      "fileHeader": ["import", "export", "public", "class", "function", "def"],
      "folderIndex": ["new-file", "delete-file", "import-change", "export-change"],
      "projectIndex": ["folder-structure-change", "major-refactor"]
    }
  },

  "visualization": {
    "description": "依赖关系图配置",

    "maxNodes": 50,
    "description": "依赖图最大节点数，超过则仅显示核心模块",

    "maxEdges": 100,
    "description": "依赖图最大边数，超过则省略第三方库依赖",

    "groupByFolder": true,
    "description": "是否按文件夹分组显示（使用 subgraph）",

    "showLabels": true,
    "description": "是否在边上显示依赖类型标签",

    "highlightCircular": true,
    "description": "是否高亮显示循环依赖",

    "omitThirdParty": false,
    "description": "是否在图中省略第三方依赖",

    "layout": "TB",
    "description": "图的布局方向: TB(上到下), LR(左到右), BT(下到上), RL(右到左)"
  },

  "fileHeader": {
    "description": "文件头注释配置",

    "template": "auto",
    "description": "模板选择: auto(自动检测), custom(自定义路径)",

    "customTemplatePath": null,
    "description": "自定义模板文件路径（当 template = custom 时）",

    "preserveExisting": true,
    "description": "是否保留现有的用户注释（智能合并）",

    "includeAuthor": false,
    "description": "是否自动添加 @author 标签",

    "includeLicense": false,
    "description": "是否自动添加 @license 标签",

    "autoGeneratedMarker": "<!-- auto-generated -->",
    "description": "自动生成内容的标记，用于区分用户手动内容"
  },

  "languages": {
    "description": "语言特定配置",

    "javascript": {
      "enabled": true,
      "extensions": [".js", ".jsx", ".mjs", ".cjs"],
      "commentStyle": "jsdoc"
    },
    "typescript": {
      "enabled": true,
      "extensions": [".ts", ".tsx"],
      "commentStyle": "jsdoc",
      "excludeTypes": true,
      "description": "是否排除 .d.ts 类型定义文件"
    },
    "python": {
      "enabled": true,
      "extensions": [".py"],
      "commentStyle": "docstring",
      "respectDunderAll": true,
      "description": "是否优先使用 __all__ 定义的导出"
    },
    "java": {
      "enabled": true,
      "extensions": [".java"],
      "commentStyle": "javadoc"
    },
    "kotlin": {
      "enabled": true,
      "extensions": [".kt", ".kts"],
      "commentStyle": "kdoc"
    },
    "rust": {
      "enabled": true,
      "extensions": [".rs"],
      "commentStyle": "rustdoc"
    },
    "go": {
      "enabled": true,
      "extensions": [".go"],
      "commentStyle": "godoc"
    },
    "cpp": {
      "enabled": true,
      "extensions": [".cpp", ".cc", ".cxx", ".c", ".h", ".hpp", ".hxx"],
      "commentStyle": "doxygen",
      "analyzeHeadersOnly": true,
      "description": "是否仅分析头文件的 Output"
    },
    "php": {
      "enabled": true,
      "extensions": [".php"],
      "commentStyle": "phpdoc"
    },
    "ruby": {
      "enabled": true,
      "extensions": [".rb"],
      "commentStyle": "rdoc"
    },
    "swift": {
      "enabled": true,
      "extensions": [".swift"],
      "commentStyle": "markup"
    },
    "csharp": {
      "enabled": true,
      "extensions": [".cs"],
      "commentStyle": "xmldoc"
    }
  },

  "performance": {
    "description": "性能优化配置",

    "enableCache": true,
    "description": "是否启用会话级缓存",

    "maxConcurrency": 10,
    "description": "并发分析文件的最大数量",

    "timeout": {
      "fileAnalysis": 30000,
      "description": "单个文件分析超时（毫秒）",
      "totalProcess": 600000,
      "description": "整体流程超时（毫秒，10分钟）"
    },

    "batchWrite": true,
    "description": "是否批量写入文件以减少 I/O"
  },

  "output": {
    "description": "输出格式配置",

    "verboseMode": false,
    "description": "是否显示详细日志",

    "quietMode": false,
    "description": "静默模式，仅在出错时输出",

    "reportFormat": "text",
    "description": "报告格式: text, json, markdown",

    "colorOutput": true,
    "description": "是否使用彩色输出（终端支持时）"
  },

  "validation": {
    "description": "验证配置",

    "strictMode": false,
    "description": "严格模式：任何警告都视为错误",

    "checkCircularDeps": true,
    "description": "是否检测循环依赖",

    "checkOrphanedModules": true,
    "description": "是否检测孤立模块",

    "checkMissingDeps": true,
    "description": "是否检查缺失的依赖文件",

    "validateSyntax": false,
    "description": "是否验证文件语法（深度检查，耗时）"
  },

  "customRules": {
    "description": "自定义规则（高级配置）",

    "dependencyPatterns": {
      "description": "自定义依赖匹配模式",
      "javascript": {
        "import": ["import\\s+.*?from\\s+['\"](.+?)['\"]", "require\\(['\"](.+?)['\"]\\)"],
        "export": ["export\\s+(?:default\\s+)?(?:class|function|const|let|var)\\s+(\\w+)"]
      }
    },

    "positionInference": {
      "description": "位置推断规则",
      "patterns": {
        "**/controllers/**": "API层-控制器",
        "**/services/**": "业务层-服务",
        "**/models/**": "数据层-模型",
        "**/utils/**": "工具层",
        "**/middleware/**": "中间件",
        "**/components/**": "UI层-组件"
      }
    }
  }
}
